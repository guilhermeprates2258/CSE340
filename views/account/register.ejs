<% if (messages) { %>
  <%- messages() %>
<% } %>

<% if (errors) { %>
  <ul class="notice">
    <% errors.array().forEach(error => { %>
      <li><%= error.msg %></li>
    <% }) %>
  </ul>
<% } %>


<section class="auth">
  <h1><%= title %></h1>

  <form class="auth__form" action="/account/register" method="post">
    <label for="account_firstname">First Name</label>
    <input
      type="text"
      id="account_firstname"
      name="account_firstname"
      required
      value="<%= (locals.account_firstname || '') %>"
      autocomplete="given-name"
    >

    <label for="account_lastname">Last Name</label>
    <input
      type="text"
      id="account_lastname"
      name="account_lastname"
      required
      value="<%= (locals.account_lastname || '') %>"
      autocomplete="family-name"
    >

    <label for="account_email">Email</label>
    <input
      type="email"
      placeholder="you@example.com"
      id="account_email"
      name="account_email"
      required
      value="<%= (locals.account_email || '') %>"
      autocomplete="email"
    >

    <label for="account_password">Password</label>
    <div class="auth__password">
      <input
        type="password"
        id="account_password"
        name="account_password"
        required
        aria-describedby="pw-rules"
        autocomplete="new-password"
        pattern="^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[^a-zA-Z0-9])(?!.*\s).{12,}$"
      >
      <button type="button" class="btn-secondary" id="togglePassword">
        Show
      </button>
    </div>

    <p class="auth__rules" id="pw-rules">
      Password must be at least <strong>12 characters</strong> and include
      <strong>1 uppercase letter</strong>, <strong>1 number</strong>, and
      <strong>1 special character</strong>.
    </p>

    <button type="submit" class="btn-primary">Create Account</button>
  </form>

  <p class="auth__alt">
    Already have an account?
    <a href="/account/login">Sign in here</a>
  </p>
</section>

<script>
  // Optional: toggle password visibility
  const toggleBtn = document.getElementById("togglePassword");
  const pw = document.getElementById("account_password");

  if (toggleBtn && pw) {
    toggleBtn.addEventListener("click", () => {
      const isHidden = pw.getAttribute("type") === "password";
      pw.setAttribute("type", isHidden ? "text" : "password");
      toggleBtn.textContent = isHidden ? "Hide" : "Show";
    });
  }
</script>
